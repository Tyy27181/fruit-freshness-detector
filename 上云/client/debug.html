<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试模式 - 智能终端管理系统</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app">
        <!-- 侧边栏 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-network-wired"></i>
                    <span>Terminal</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-panel="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>仪表盘</span>
                </a>
                <a href="#" class="nav-item" data-panel="connection">
                    <i class="fas fa-plug"></i>
                    <span>连接管理</span>
                </a>
                <a href="#" class="nav-item" data-panel="messages">
                    <i class="fas fa-comments"></i>
                    <span>消息中心</span>
                </a>
                <a href="#" class="nav-item" data-panel="settings">
                    <i class="fas fa-cog"></i>
                    <span>系统设置</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" class="mode-switch-btn">
                    <i class="fas fa-home"></i>
                    <span>返回用户模式</span>
                </a>
                <div class="version-info">
                    <span>v1.0.0 调试模式</span>
                </div>
            </div>
        </aside>

        <!-- 主内容区 -->
        <div class="main-wrapper">
            <!-- 顶部导航栏 -->
            <header class="topbar">
                <div class="topbar-left">
                    <button class="menu-toggle" id="menuToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">仪表盘</h1>
                </div>
                <div class="topbar-right">
                    <div class="user-info" id="userInfo">
                        <i class="fas fa-user-circle"></i>
                        <span id="usernameDisplay">--</span>
                        <button class="logout-btn" onclick="logout()" title="退出登录">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                    <div class="connection-status" id="connectionStatus">
                        <div class="status-indicator">
                            <span class="status-dot"></span>
                            <span class="status-text">未连接</span>
                        </div>
                    </div>
                    <div class="current-time" id="currentTime"></div>
                </div>
            </header>

            <!-- 主内容 -->
            <main class="main-content">
                <!-- 仪表盘面板 -->
                <div class="panel active" id="dashboardPanel">
                    <!-- 统计卡片 -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon" style="--accent-color: #6366f1;">
                                <i class="fas fa-plug"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="statStatus">离线</span>
                                <span class="stat-label">连接状态</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="--accent-color: #10b981;">
                                <i class="fas fa-paper-plane"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="statSent">0</span>
                                <span class="stat-label">已发送消息</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="--accent-color: #f59e0b;">
                                <i class="fas fa-inbox"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="statReceived">0</span>
                                <span class="stat-label">已接收消息</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon" style="--accent-color: #ec4899;">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="statOnline">0</span>
                                <span class="stat-label">在线终端</span>
                            </div>
                        </div>
                    </div>

                    <!-- 快速操作 -->
                    <div class="card quick-actions">
                        <div class="card-header">
                            <h3><i class="fas fa-bolt"></i> 快速操作</h3>
                        </div>
                        <div class="card-body">
                            <div class="action-buttons">
                                <button class="action-btn" id="quickConnect">
                                    <i class="fas fa-link"></i>
                                    <span>快速连接</span>
                                </button>
                                <button class="action-btn" id="quickDisconnect" disabled>
                                    <i class="fas fa-unlink"></i>
                                    <span>断开连接</span>
                                </button>
                                <button class="action-btn" id="clearLogs">
                                    <i class="fas fa-trash-alt"></i>
                                    <span>清空日志</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 实时日志预览 -->
                    <div class="card log-preview">
                        <div class="card-header">
                            <h3><i class="fas fa-terminal"></i> 实时日志</h3>
                            <span class="badge" id="logCount">0 条</span>
                        </div>
                        <div class="card-body">
                            <div class="log-container" id="dashboardLog"></div>
                        </div>
                    </div>
                </div>

                <!-- 连接管理面板 -->
                <div class="panel" id="connectionPanel">
                    <div class="panel-grid">
                        <!-- 服务器配置 -->
                        <div class="card config-card">
                            <div class="card-header">
                                <h3><i class="fas fa-server"></i> 服务器配置</h3>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label for="serverHost">
                                        <i class="fas fa-globe"></i> 服务器地址
                                    </label>
                                    <div class="input-wrapper">
                                        <input type="text" id="serverHost" placeholder="ws://139.159.209.44:8080" value="ws://139.159.209.44:8080">
                                        <span class="input-icon"><i class="fas fa-network-wired"></i></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="serverPort">
                                        <i class="fas fa-hashtag"></i> 端口号
                                    </label>
                                    <div class="input-wrapper">
                                        <input type="number" id="serverPort" placeholder="完整URL时留空" value="">
                                        <span class="input-icon"><i class="fas fa-plug"></i></span>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button id="connectBtn" class="btn btn-primary">
                                        <i class="fas fa-plug"></i>
                                        <span>连接服务器</span>
                                    </button>
                                    <button id="disconnectBtn" class="btn btn-danger" disabled>
                                        <i class="fas fa-times"></i>
                                        <span>断开连接</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 连接信息 -->
                        <div class="card info-card">
                            <div class="card-header">
                                <h3><i class="fas fa-info-circle"></i> 连接信息</h3>
                            </div>
                            <div class="card-body">
                                <div class="info-list" id="connectionInfo">
                                    <div class="info-item">
                                        <span class="info-label">状态</span>
                                        <span class="info-value" id="infoStatus">
                                            <span class="status-badge offline">未连接</span>
                                        </span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">服务器</span>
                                        <span class="info-value" id="infoServer">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">客户端ID</span>
                                        <span class="info-value" id="infoClientId">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">连接时间</span>
                                        <span class="info-value" id="infoConnectTime">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">在线时长</span>
                                        <span class="info-value" id="infoUptime">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 消息中心面板 -->
                <div class="panel" id="messagesPanel">
                    <div class="message-panel">
                        <!-- 消息日志 -->
                        <div class="card message-log-card">
                            <div class="card-header">
                                <h3><i class="fas fa-stream"></i> 消息日志</h3>
                                <div class="header-actions">
                                    <button class="icon-btn" id="scrollToBottom" title="滚动到底部">
                                        <i class="fas fa-chevron-down"></i>
                                    </button>
                                    <button class="icon-btn" id="clearMessages" title="清空消息">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="message-log" id="messageLog"></div>
                            </div>
                            <div class="card-footer">
                                <div class="message-input-wrapper">
                                    <div class="input-container">
                                        <input type="text" id="messageInput" placeholder="输入消息，按 Enter 发送..." disabled>
                                        <button id="sendBtn" class="send-btn" disabled>
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 设置面板 -->
                <div class="panel" id="settingsPanel">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-cog"></i> 系统设置</h3>
                        </div>
                        <div class="card-body">
                            <div class="settings-group">
                                <h4>显示设置</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <span class="setting-label">深色模式</span>
                                        <span class="setting-desc">切换界面主题颜色</span>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="darkModeToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <span class="setting-label">消息时间戳</span>
                                        <span class="setting-desc">在消息前显示时间</span>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="timestampToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <span class="setting-label">自动滚动</span>
                                        <span class="setting-desc">新消息时自动滚动到底部</span>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="autoScrollToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                            <div class="settings-group">
                                <h4>连接设置</h4>
                                <div class="setting-item">
                                    <div class="setting-info">
                                        <span class="setting-label">自动重连</span>
                                        <span class="setting-desc">断开连接后自动尝试重新连接</span>
                                    </div>
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="autoReconnectToggle">
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Toast 通知容器 -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="js/websocket.js"></script>
    <script src="js/debug-app.js"></script>
    <script>
        // 登录检查
        function checkLogin() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (isLoggedIn !== 'true') {
                window.location.href = 'login.html';
                return false;
            }
            const username = sessionStorage.getItem('username') || '用户';
            document.getElementById('usernameDisplay').textContent = username;
            return true;
        }

        // 退出登录
        function logout() {
            if (confirm('确定要退出登录吗？')) {
                sessionStorage.removeItem('isLoggedIn');
                sessionStorage.removeItem('username');
                window.location.href = 'login.html';
            }
        }

        checkLogin();
    </script>
</body>
</html>
