<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录 - 水果成熟度检测系统</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="login-container">
        <!-- 背景装饰 -->
        <div class="bg-decoration">
            <div class="circle circle-1"></div>
            <div class="circle circle-2"></div>
            <div class="circle circle-3"></div>
        </div>

        <!-- 登录卡片 -->
        <div class="login-card">
            <div class="login-header">
                <div class="logo">
                    <i class="fas fa-lemon"></i>
                </div>
                <h1>FruitGuard</h1>
                <p>水果成熟度智能检测系统</p>
            </div>

            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="username">
                        <i class="fas fa-user"></i>
                        用户名
                    </label>
                    <input type="text" id="username" placeholder="请输入用户名" autocomplete="username" required>
                </div>

                <div class="form-group">
                    <label for="password">
                        <i class="fas fa-lock"></i>
                        密码
                    </label>
                    <div class="password-wrapper">
                        <input type="password" id="password" placeholder="请输入密码" autocomplete="current-password" required>
                        <button type="button" class="toggle-password" onclick="togglePassword()">
                            <i class="fas fa-eye" id="eyeIcon"></i>
                        </button>
                    </div>
                </div>

                <div class="form-options">
                    <label class="remember-me">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        记住我
                    </label>
                </div>

                <p class="error-message" id="errorMessage"></p>

                <button type="submit" class="login-btn">
                    <span>登 录</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
            </form>

            <div class="login-footer">
            </div>
        </div>

        <!-- 版本信息 -->
        <div class="version">
            <span>FruitGuard v1.0.0</span>
        </div>
    </div>

    <script>
        // 用户账号（实际项目中应该在后端验证）
        const USERS = {
            'liuzhen': '1234'
        };

        // 检查是否已登录
        function checkLogin() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                window.location.href = 'index.html';
            }
        }

        // 页面加载时检查
        checkLogin();

        // 加载记住的用户名
        const rememberedUser = localStorage.getItem('rememberedUser');
        if (rememberedUser) {
            document.getElementById('username').value = rememberedUser;
            document.getElementById('rememberMe').checked = true;
        }

        // 切换密码显示
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const eyeIcon = document.getElementById('eyeIcon');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.classList.remove('fa-eye');
                eyeIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                eyeIcon.classList.remove('fa-eye-slash');
                eyeIcon.classList.add('fa-eye');
            }
        }

        // 登录表单提交
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            const errorMessage = document.getElementById('errorMessage');

            // 验证用户名和密码
            if (USERS[username] && USERS[username] === password) {
                // 记住用户名
                if (rememberMe) {
                    localStorage.setItem('rememberedUser', username);
                } else {
                    localStorage.removeItem('rememberedUser');
                }

                // 设置登录状态
                sessionStorage.setItem('isLoggedIn', 'true');
                sessionStorage.setItem('username', username);

                // 跳转到主页
                window.location.href = 'index.html';
            } else {
                // 显示错误信息
                errorMessage.textContent = '用户名或密码错误';
                errorMessage.classList.add('show');

                // 添加抖动效果
                const loginCard = document.querySelector('.login-card');
                loginCard.classList.add('shake');
                setTimeout(() => {
                    loginCard.classList.remove('shake');
                }, 500);
            }
        });

        // 输入时清除错误信息
        document.getElementById('username').addEventListener('input', clearError);
        document.getElementById('password').addEventListener('input', clearError);

        function clearError() {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = '';
            errorMessage.classList.remove('show');
        }
    </script>
</body>
</html>
